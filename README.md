# 1.准备工作
## 从ROM中导出Narc
使用[tinke](https://github.com/pleonex/tinke)读取*.nds导出a/0/0/2、a/0/0/3和a/0/2/3这三个Narc文件
其中：

a/0/0/2 系统文本集

a/0/0/3 剧情文本集

a/0/2/3 字体集（字库）

## Narc解包
### 示例
*此处仅为使用方法的示例*

為了方便後續操作，建议将上述通过tinke提取出来的文件重命名，以日版(JP)的Narc文件为例：

a/0/0/2提取出来的2 重命名为 B(JP)2

a/0/0/3提取出来的3 重命名为 B(JP)3

a/0/2/3提取出来的3 重命名为 a023

将这些Narc文件与*.py放在同级目录下，在控制台Command Line(CMD)中按

ExtractNarc.py <narc文件名> <处理类型：输入text（文本）或file（其它）>执行语句：

`>>`python ExtractNarc.py B(JP)2 text

`>>`python ExtractNarc.py B(JP)3 text

`>>`python ExtractNarc.py a023 file

由此就创建了：

B(JP)2_extr、B(JP)3_extr和a023_extr这三个分别对应B(JP)2、B(JP)3和a023的子文件夹。

B(JP)2_extr、B(JP)3_extr内应当有：解包后按照<>编号命名的文件块（无后缀）和对应的解密后的文本*.txt

a023_extr内应当有：解包后按照编号命名的文件块（无后缀）

# 2.文本处理
*整体流程：*

拆文本→翻译（修改）文本→做码表→改字库→文本和字库都导入narc打包→tinke导入对应New

## 拆文本组合为原译文对照
→直接运行CMP_Div_main.py脚本，按照提示制作对照文本。

### 示例：
依然以 1.准备工作 中的示例文件命名为例：

`>>`python CMP_Div_main.py

`>>`请输入当前目录下已利用ExtractNarc.py导出的文本对应的源Narc文件名：B(JP)3

`>>`请选择操作：CMP

由此就会在B(JP)3_extr\目录下创建名为B3_CMP的文件夹，其中包含0和1两个分块的原译文对照文本。
要修改的是0和1两个文件夹中的文本。

### 翻译示例：
以.\B(JP)3_extr\B3_CMP\0\0_CMP_B3-23.txt中的第一段文本0_0I为例：

0_0I

\------------------------------

はくぶつかんの　そのおくで

ちょうせんしゃを　まつ`<F>`

ポケモンジム……`<F>`



なんだか　ふんいき　あるっすよね`<PAGE>`



というわけで

これを　さしあげるっす！`<PAGE>`



\------------------------------

はくぶつかんの　そのおくで

ちょうせんしゃを　まつ`<F>`

ポケモンジム……`<F>`



なんだか　ふんいき　あるっすよね`<PAGE>`



というわけで

これを　さしあげるっす！`<PAGE>`



\------------------------------

上面的部分是原文，下面的部分是译文，因此直接修改翻译下面的部分即可：

0_0I

\------------------------------

はくぶつかんの　そのおくで

ちょうせんしゃを　まつ`<F>`

ポケモンジム……`<F>`



なんだか　ふんいき　あるっすよね`<PAGE>`



というわけで

これを　さしあげるっす！`<PAGE>`



\------------------------------

博物馆里面是

等待着挑战者的宝可梦道馆……`<F>`



感觉真有气氛啊。`<PAGE>`



哦对了，

这个给你！`<PAGE>`



\------------------------------
#### 控制符
`<>`中包括的是控制符，翻译时建议尽量按照原文的格式摆放。

不过对于`<PAGE>`和`<F>`，翻译者可以酌情考虑变更。

在游戏中的效果：

`<PAGE>`的作用是：显示翻页的运动箭头▼，并且按A后整个对话框翻一页。也就是按A后，`<PAGE>`后的文段直接覆盖`<PAGE>`所在的文段。

以上面的翻译为例：“感觉真有气氛啊。`<PAGE>`”按A，对话框的两行字直接换成“哦对了，

这个给你！`<PAGE>`”。

`<F>`的作用是：按A后，`<F>`后面的一段文字把`<F>`所在的这段文字顶到上面去。

以上面的翻译为例：“等待着挑战者的宝可梦道馆……`<F>`”按A，

“
感觉真有气氛啊。<PAGE>”往上滑动，顶去“等待着挑战者的宝可梦道馆……<F>”。

## 文本导入打包流程

### 组合文本
→直接运行CMP_Div_main.py脚本按照提示组合文本。

#### 示例：
依然以 1.准备工作 中的示例文件命名为例：

`>>`python CMP_Div_main.py

`>>`请输入当前目录下已利用ExtractNarc.py导出的文本对应的源Narc文件名：B(JP)3

`>>`请选择操作：Restore

`>>` 请输入拟定创造的新Narc文件名：B(CH)3

组合后的文本就在B(CH)2_extr/目录下，并且已经创建好了待写入的对应文本块。

### 导入文本到对应Narc分片中
→用InjectTXTNarc.py批量导入分片。
#### 示例：
依然以 1.准备工作 中的示例文件命名为例：

`>>`python .\InjectTXTNarc.py B(CH)3

待程式正确执行后，这样就将B(CH)3_extr\中的所有*txt导入对应的Narc分片中了。

### 打包Narc
→用MakeNarc.py打包文本Narc生成对应的New_Narc
#### 示例：
依然以 1.准备工作 中的示例文件命名为例：

`>>`python .\MakeNarc.py B(CH)3

这样就得到了打包后的名为New_B(CH)3的Narc.

## 做码表的流程
使用

→用WQSG对照组合的原始全码表，指定起始编码为025B，统计Counts目录的全文生成CHS.TBL的中文码表

→用覆盖重做码表.py重做新码表得到_test.TBL，即为最新码表。

## 修改重做字库调用流程
用MakeFonts_main.py参照CHS.TBL做中文字库
→用Change三件套修改Width、Bitmap和CodeList
→InjectNftr.py导入分片→MakeNarc.py打包字库生成New_a023
